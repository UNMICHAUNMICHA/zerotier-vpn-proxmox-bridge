# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ZeroTier ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LAN Bridge ‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡∏ö‡∏ô Proxmox LXC (Debian/Ubuntu)

‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ZeroTier ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LAN Bridge ‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡∏ö‡∏ô Proxmox LXC Container ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ Debian ‡∏´‡∏£‡∏∑‡∏≠ Ubuntu ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ZeroTier ‡∏Å‡∏±‡∏ö LAN ‡∏à‡∏£‡∏¥‡∏á ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ NAT ‡πÅ‡∏•‡∏∞ static route

---

## üß± ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ
- **‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Linux**: ‡πÄ‡∏ä‡πà‡∏ô Ubuntu 22.04/24.04 ‡∏´‡∏£‡∏∑‡∏≠ Debian 12 ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô‡πÉ‡∏ô Proxmox LXC
- **LAN Interface**: ‡πÄ‡∏ä‡πà‡∏ô `ens18` (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ `ip a`)
- **ZeroTier Network**: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï (authorized) ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏ô ZeroTier Central
- **Network LAN ‡∏à‡∏£‡∏¥‡∏á**: ‡πÄ‡∏ä‡πà‡∏ô `192.168.0.0/24`
- **ZeroTier IP**: ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á bridge ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö IP ‡πÄ‡∏ä‡πà‡∏ô `192.168.192.x`

---

## ü™ú ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô

### 0. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ZeroTier
1. **‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ZeroTier One**  
   - ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ZeroTier ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:
     ```bash
     curl -s https://install.zerotier.com | sudo bash
     ```
     ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢ GPG:
     ```bash
     curl -s 'https://pgp.mit.edu/pks/lookup?op=get&search=0x1657198823E52A61' | sudo gpg --import && \
     if z=$(curl -s 'https://install.zerotier.com/' | gpg); then echo "$z" | sudo bash; fi
     ```

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á**  
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ZeroTier ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
     ```bash
     sudo zerotier-cli info
     ```
     ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡πà‡∏ô Address ‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ONLINE

---

### 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° LXC Container
1. **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Config ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Unprivileged Container**  
   - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå `/etc/pve/lxc/<CTID>.conf` (‡πÅ‡∏ó‡∏ô `<CTID>` ‡∏î‡πâ‡∏ß‡∏¢ ID ‡∏Ç‡∏≠‡∏á Container):
     ```bash
     nano /etc/pve/lxc/<CTID>.conf
     ```
   - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ZeroTier ‡πÅ‡∏•‡∏∞ Docker:
     ```plaintext
     unprivileged: 1
     features: nesting=1,keyctl=1
     lxc.apparmor.profile: unconfined
     lxc.cgroup.devices.allow: a
     lxc.cap.drop:
     lxc.cgroup2.devices.allow: c 10:200 rwm
     lxc.mount.entry: /dev/net/tun dev/net/tun none bind,create=file
     ```

2. **‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó LXC Container**  
   - ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó Container ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏°‡∏µ‡∏ú‡∏•:
     ```bash
     pct restart <CTID>
     ```

---

### 2. Join ZeroTier ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö IP
1. **Join ‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ZeroTier**  
   - ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ ZeroTier:
     ```bash
     sudo zerotier-cli join <network-id>
     ```
     ‡πÅ‡∏ó‡∏ô `<network-id>` ‡∏î‡πâ‡∏ß‡∏¢ ID ‡∏à‡∏≤‡∏Å ZeroTier Central (‡πÄ‡∏ä‡πà‡∏ô `d5e04297a16fa690`)

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞ IP**  
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö IP:
     ```bash
     sudo zerotier-cli listnetworks
     ```
     ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ñ‡∏ß‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ `OK` ‡πÅ‡∏•‡∏∞ interface ‡πÄ‡∏ä‡πà‡∏ô `ztxxxxxxx` ‡∏û‡∏£‡πâ‡∏≠‡∏° IP ‡πÄ‡∏ä‡πà‡∏ô `192.168.192.109`

---

### 3. ‡πÄ‡∏õ‡∏¥‡∏î IP Forwarding
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô IP forwarding ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô bridge:
  ```bash
  echo "net.ipv4.ip_forward = 1" | sudo tee -a /etc/sysctl.conf
  sudo sysctl -p
  ```

---

### 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ NAT (ZeroTier ‚Üí LAN)
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ iptables ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥ NAT ‡∏à‡∏≤‡∏Å ZeroTier ‡πÑ‡∏õ‡∏¢‡∏±‡∏á LAN:
  ```bash
     # ‡πÄ‡∏õ‡∏¥‡∏î IP forwarding
   sudo sysctl -w net.ipv4.ip_forward=1
   sudo sed -i 's/^#\?net.ipv4.ip_forward.*/net.ipv4.ip_forward=1/' /etc/sysctl.conf
   
   # NAT ‡∏à‡∏≤‡∏Å ZeroTier ‡πÑ‡∏õ LAN
   sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
   
   # ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï Forward
   sudo iptables -A FORWARD -i eth0 -o ztklhwkfmx -m state --state RELATED,ESTABLISHED -j ACCEPT
   sudo iptables -A FORWARD -i ztklhwkfmx -o eth0 -j ACCEPT
  ```
---

### 5. ‡∏ó‡∏≥‡πÉ‡∏´‡πâ NAT ‡∏ñ‡∏≤‡∏ß‡∏£
1. **‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á iptables-persistent**  
   - ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏é iptables:
     ```bash
     sudo apt install -y iptables-persistent
     ```
     ‡∏ï‡∏≠‡∏ö `yes` ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏é iptables ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

2. **‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô netfilter-persistent**  
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ß‡∏¥‡∏™‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:
     ```bash
     sudo systemctl enable netfilter-persistent
     sudo systemctl start netfilter-persistent
     ```

---

### 6. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Static Route ‡∏ö‡∏ô ZeroTier Central
1. **‡πÑ‡∏õ‡∏ó‡∏µ‡πà ZeroTier Central**  
   - ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏ó‡∏µ‡πà [https://my.zerotier.com](https://my.zerotier.com)
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‚Üí ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Advanced** ‚Üí **Managed Routes**

2. **‡πÄ‡∏û‡∏¥‡πà‡∏° Route**  
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° route ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
     ```
     Destination: 192.168.0.0/24
     Via: 192.168.192.109
     ```
     - `192.168.0.0/24` ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ LAN ‡∏à‡∏£‡∏¥‡∏á
     - `192.168.192.109` ‡∏Ñ‡∏∑‡∏≠ IP ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á bridge ‡πÉ‡∏ô ZeroTier

---

### 7. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
- ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏ô ZeroTier network (‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á client):
  ```bash
  ping 192.168.0.1   # ping router
  ping 192.168.0.184 # ping ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô LAN ‡∏à‡∏£‡∏¥‡∏á
  ```

---

### 8. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó
1. **‡∏£‡∏µ‡∏ö‡∏π‡∏ï‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á**  
   - ‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ñ‡∏≤‡∏ß‡∏£:
     ```bash
     sudo reboot
     ```

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏π‡∏ï**  
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ZeroTier:
     ```bash
     sudo zerotier-cli listnetworks  # ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á Status = OK
     ```
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö IP ‡πÅ‡∏•‡∏∞ interface:
     ```bash
     ip a  # ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ interface ztxxxxxxx ‡πÅ‡∏•‡∏∞ IP ‡πÄ‡∏ä‡πà‡∏ô 192.168.192.109
     ```
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏é iptables:
     ```bash
     sudo iptables -t nat -L -n -v  # ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ MASQUERADE
     ```

---

## üí¨ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
- **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢**: ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ö‡∏ö NAT ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡∏ß‡πà‡∏≤ Layer 2 bridging ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ö DHCP ‡∏´‡∏£‡∏∑‡∏≠ bridge ‡∏à‡∏£‡∏¥‡∏á
- **Reverse Route**: ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ LAN ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á ZeroTier ‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° route ‡πÅ‡∏•‡∏∞‡∏Å‡∏é iptables ‡∏ö‡∏ô router
- **ZeroTier Central**: ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï (authorize) ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡πÉ‡∏ô ZeroTier Central ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ
- **LAN Interface**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠ interface ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÄ‡∏ä‡πà‡∏ô `ens18`, `eth0`) ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `ip a`
- **Unprivileged LXC**: ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ `lxc.cgroup2.devices.allow` ‡πÅ‡∏•‡∏∞ `lxc.mount.entry` ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö unprivileged container ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ ZeroTier ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ

---
